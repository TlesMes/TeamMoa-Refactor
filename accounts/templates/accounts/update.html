{% extends 'base_minimal.html' %}
{% load static %}

{% block contents %}
<section class="auth-section">
  <div class="auth-container">
    
    <!-- 뒤로가기 버튼 -->
    <div class="back-button">
      <a href="javascript:history.back();" class="back-link">
        <i class="ri-arrow-left-line"></i>
        돌아가기
      </a>
    </div>

    <!-- 로고 및 헤더 -->
    <div class="auth-header">
      <div class="logo-section">
        <div class="logo-icon">
          <i class="ri-user-settings-line"></i>
        </div>
        <h1 class="site-title">프로필 수정</h1>
      </div>
      <h2 class="auth-title">내 정보 관리</h2>
    </div>

    <!-- 프로필 수정 폼 -->
    <div class="auth-card">
      <form method="POST" action="." class="auth-form profile-form">
        {% csrf_token %}
        
        {% for field in user_change_form %}
          <div class="form-group">
            <label for="{{ field.id_for_label }}">{{ field.label }}</label>
            
            {% if field.field.widget.input_type == 'email' %}
              <div class="input-wrapper">
                <i class="ri-mail-line"></i>
                <input 
                  type="email" 
                  name="{{ field.name }}" 
                  id="{{ field.id_for_label }}" 
                  value="{{ field.value|default_if_none:'' }}"
                  class="form-control"
                >
              </div>
            {% elif field.name == 'nickname' %}
              <div class="input-wrapper">
                <i class="ri-user-smile-line"></i>
                <input 
                  type="text" 
                  name="{{ field.name }}" 
                  id="{{ field.id_for_label }}" 
                  value="{{ field.value|default_if_none:'' }}"
                  class="form-control"
                >
              </div>
            {% elif field.name == 'profile' %}
              <div class="input-wrapper textarea-wrapper">
                <i class="ri-file-text-line"></i>
                <textarea 
                  name="{{ field.name }}" 
                  id="{{ field.id_for_label }}" 
                  class="form-control"
                  rows="4"
                >{{ field.value|default_if_none:'' }}</textarea>
              </div>
            {% else %}
              <div class="input-wrapper">
                <i class="ri-user-line"></i>
                <input 
                  type="{{ field.field.widget.input_type|default:'text' }}" 
                  name="{{ field.name }}" 
                  id="{{ field.id_for_label }}" 
                  value="{{ field.value|default_if_none:'' }}"
                  class="form-control"
                >
              </div>
            {% endif %}
            
            {% if field.errors %}
              {% for error in field.errors %}
                <div class="field-error">{{ error }}</div>
              {% endfor %}
            {% endif %}
          </div>
        {% endfor %}

        <button type="submit" class="auth-btn">
          <i class="ri-save-line"></i>
          변경사항 저장
        </button>
      </form>

      <!-- 추가 링크 섹션 -->
      <div class="auth-links">
        <a href="{% url 'accounts:password' %}" class="link-secondary">
          <i class="ri-lock-password-line"></i>
          비밀번호 변경
        </a>
      </div>

      <!-- 계정 정보 섹션 -->
      <div class="account-info">
        <div class="info-title">
          <i class="ri-information-line"></i>
          계정 정보
        </div>
        <div class="info-item">
          <span class="info-label">가입일:</span>
          <span class="info-value">{{ user.date_joined|date:"Y년 m월 d일" }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">최근 로그인:</span>
          <span class="info-value">{{ user.last_login|date:"Y년 m월 d일 H:i" }}</span>
        </div>
      </div>
    </div>

  </div>
</section>
{% endblock %}
